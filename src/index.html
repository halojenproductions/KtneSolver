<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>KTNE Solver</title>
		<link rel="icon" type="image/png" href="img/favicon.png">
	</head>

	<body onload="setup()">
		<div class="container-fluid">
			<div class="row align-items-start">
				<div class="col-auto col-md-3 col-xl-2 px-sm-2 px-0 bg-dark position-sticky top-0 start-0">
					<div class="d-flex flex-column align-items-left align-items-sm-start px-3 pt-2 min-vh-100">
						<p>
							Version: 1<br />
							Verification Code: 241
						</p>
						<ul class="nav nav-pills flex-column mb-auto">
							<li class="nav-item">
								<a class="nav-link" href="#BasicWires">Basic wires</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#MissileButton">Button</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#Keypad">Keypad</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#SimonSays"
									target="_blank">Simon Says</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#WhosOnFirst"
									target="_blank">Who's On First</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#Memory"
									target="_blank">Memory</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#MorseCode"
									target="_blank">Morse Code</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#ComplicatedWires"
									target="_blank">Complicated Wires</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#WireSequences"
									target="_blank">Wire Sequences</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="https://bombmanual.com/web/index.html#Mazes"
									target="_blank">Mazes</a>
							</li>
							<li class="nav-item">
								<a class="nav-link" href="#Password">Password</a>
							</li>
						</ul>
					</div>
				</div>

				<div class="col">
					<div class="row">
						<header class="col-12 pt-3">
							<!-- <div class=" w-100 "> -->
							<h3>Keep Talking and Nobody Explodes</h3>
							<!-- </div> -->
						</header>
					</div>
					<div class="row">
						<div class="col module pt-3" id="BasicWires">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Basic wires</span>
									<button type="reset" class="btn btn-sm btn-outline-secondary float-end" form="BasicWiresForm"></button>
								</div>
								<div class="card-body">
									<form id="BasicWiresForm">
										<script type="text/javascript">
											var basicwires_inputs = document.getElementById("BasicWiresForm");
											var colours = [["Red", "red"], ["Blue", "blue"], ["Yellow", "yellow"], ["Black", "black"], ["White", "white"]];

											for (i = 1; i <= 6; i++) {
												var group = document.createElement("div");
												group.className = "btn-group btn-group-sm d-flex";
												group.setAttribute("role", "group");

												// var label = document.createElement("label");
												// label.className = `btn-label`;
												// label.appendChild(document.createTextNode(`Wire ${i}`));
												// group.appendChild(label);

												for (ii = 0; ii < 5; ii++) {
													var input = document.createElement("input");
													input.id = `basicwires_${i}_${ii}`;
													input.className = `btn-check basicwires basicwires_${colours[ii][1]}`;
													input.setAttribute("type", "radio");
													input.setAttribute("name", `basicwires_${i}`);
													input.setAttribute("autocomplete", "off");
													input.setAttribute("value", `${colours[ii][1]}`);

													var label = document.createElement("label");
													label.className = `btn btn-outline-primary flex-grow-1 colour-${colours[ii][1]}`;
													label.setAttribute("for", `basicwires_${i}_${ii}`);
													label.appendChild(document.createTextNode(`${colours[ii][0]}`));

													group.appendChild(input);
													group.appendChild(label);
												}

												basicwires_inputs.appendChild(group);
											}
										</script>
									</form>
									<hr />
									<div class="text-success" id="basicwires_solution"></div>
								</div>
							</div>
						</div>

						<div class="col module pt-3" id="MissileButton">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Button</span>
								</div>
								<div class="card-body" id="">
									<form id="MissileButtonForm" class="d-inline">
										<div class="btn-group-sm btn-group-vertical align-top" role="group">
											<input type="radio" class="btn-check blue" name="button_colour" id="button_colour1" autocomplete="off" />
											<label class="btn btn-outline-primary colour-blue" for="button_colour1">Blue</label>

											<input type="radio" class="btn-check" name="button_colour" id="button_colour2" autocomplete="off" />
											<label class="btn btn-outline-primary colour-white" for="button_colour2">White</label>

											<input type="radio" class="btn-check" name="button_colour" id="button_colour3" autocomplete="off" />
											<label class="btn btn-outline-primary colour-yellow" for="button_colour3">Yellow</label>

											<input type="radio" class="btn-check" name="button_colour" id="button_colour4" autocomplete="off" />
											<label class="btn btn-outline-primary colour-red" for="button_colour4">Red</label>
										</div>

										<div class="btn-group-sm btn-group-vertical align-top" role="group">
											<input type="radio" class="btn-check" name="button_word" id="button_word1" autocomplete="off" />
											<label class="btn btn-outline-primary" for="button_word1">Abort</label>

											<input type="radio" class="btn-check" name="button_word" id="button_word2" autocomplete="off" />
											<label class="btn btn-outline-primary" for="button_word2">Detonate</label>

											<input type="radio" class="btn-check" name="button_word" id="button_word3" autocomplete="off" />
											<label class="btn btn-outline-primary" for="button_word3">Hold</label>
										</div>
									</form>

									<div class="btn-group-sm btn-group-vertical align-top d-none" role="group" id="button_batteries">
										<input type="radio" class="btn-check" name="button_batts" id="button_batts1" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_batts1">&lt;=1 cells</label>

										<input type="radio" class="btn-check" name="button_batts" id="button_batts2" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_batts2">&gt;1 cell</label>

										<input type="radio" class="btn-check" name="button_batts" id="button_batts3" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_batts3">&gt;2 cells</label>
									</div>

									<div class="btn-group-sm btn-group-vertical align-top d-none" role="group" id="button_car">
										<input type="radio" class="btn-check" name="button_car" id="button_car1" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_car1">No CAR</label>

										<input type="radio" class="btn-check" name="button_car" id="button_car2" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_car2">CAR</label>
									</div>

									<div class="btn-group-sm btn-group-vertical align-top d-none" role="group" id="button_frk">
										<input type="radio" class="btn-check" name="button_frk" id="button_frk1" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_frk1">No FRK</label>

										<input type="radio" class="btn-check" name="button_frk" id="button_frk2" autocomplete="off" />
										<label class="btn btn-outline-primary" for="button_frk2">FRK</label>
									</div>

									<hr class="solution d-none" />
									<div class="solution d-none text-success"></div>
								</div>
							</div>
						</div>

						<div class="col module pt-3" id="Keypad">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Keypad</span>
								</div>
								<div class="card-body">
									<form id="KeypadForm" class="d-inline">
									</form>

									<hr class="solution d-none" />
									<div class="solution d-none text-success fs-2 d-flex justify-content-around"></div>
								</div>
							</div>
						</div>
					</div>
					<div class="row">
						<div class="col module pt-3" id="Simon">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Simon Says</span>
								</div>
								<div class="card-body" id="SimonAttributes"></div>
								<div class="card-body">
									<form id="SimonForm" class="d-inline">
									</form>

									<hr class="solution d-none" />
									<div class="solution d-none text-success d-flex justify-content-around"></div>
								</div>
							</div>
						</div>

						<div class="col module pt-3" id="Password">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Password</span>
								</div>
								<div class="card-body">
									<form id="PasswordForm" class="d-inline">
										<div class="input-group">
											<input id="passwd_letters1" placeholder="1" type="text" class="possible form-control" autocomplete="off" />
											<input id="passwd_letters2" placeholder="2" type="text" class="possible form-control" autocomplete="off" />
											<input id="passwd_letters3" placeholder="3" type="text" class="possible form-control" autocomplete="off" />
											<input id="passwd_letters4" placeholder="4" type="text" class="possible form-control" autocomplete="off" />
											<input id="passwd_letters5" placeholder="5" type="text" class="possible form-control" autocomplete="off" />
										</div>
									</form>
									<hr class="solution d-none" />
									<div class="solution d-none text-success"></div>
								</div>
							</div>
						</div>

						<div class="col module pt-3" id="Complicated" data-why="https://youtu.be/5NPBIwQyPWE">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Complicated wires</span>
								</div>
								<form id="ComplicatedForm" class="d-inline">
									<div class="card-body" id="complicated_inputs"></div>
								</form>
								<div class="card-body" id="complicated_optional">
									<div class="btn-group-sm btn-group-vertical align-top d-none" role="group"
										id="complicated_batteries">
										<input type="radio" class="btn-check" name="complicated_b" id="complicated_b1"
											autocomplete="off" />
										<label class="btn btn-outline-primary" for="complicated_b1">&lt;2 cells</label>
										<input type="radio" class="btn-check" name="complicated_b" id="complicated_b2"
											autocomplete="off" />
										<label class="btn btn-outline-primary" for="complicated_b2">&ge;2 cells</label>
									</div>
									<div class="btn-group-sm btn-group-vertical align-top d-none" role="group"
										id="complicated_serial">
										<input type="radio" class="btn-check" name="complicated_s" id="complicated_s1"
											autocomplete="off" />
										<label class="btn btn-outline-primary" for="complicated_s1">Even serial</label>
										<input type="radio" class="btn-check" name="complicated_s" id="complicated_s2"
											autocomplete="off" />
										<label class="btn btn-outline-primary" for="complicated_s2">Odd serial</label>
									</div>
									<div class="btn-group-sm btn-group-vertical align-top d-none" role="group"
										id="complicated_parallel">
										<input type="radio" class="btn-check" name="complicated_p" id="complicated_p1"
											autocomplete="off" />
										<label class="btn btn-outline-primary" for="complicated_p1">Parallel
											Port</label>
										<input type="radio" class="btn-check" name="complicated_p" id="complicated_p2"
											autocomplete="off" />
										<label class="btn btn-outline-primary" for="complicated_p2">No Parallel
											Port</label>
									</div>
								</div>
							</div>
						</div>						
					</div>
					<div class="row">
						<div class="col module pt-3" id="Knobs">
							<div class="card">
								<div class="card-header">
									<span class="float-start">Knobs</span>
								</div>
								<div class="card-body">
									<form id="KnobsForm" class="d-inline">
									</form>
									<hr class="solution d-none" />
									<div class="solution d-none text-success fs-2 d-flex justify-content-around"></div>
								</div>
							</div>
						</div>
						<div class="col module pt-3" id=""></div>
						<div class="col module pt-3" id=""></div>
					</div>
				</div>
			</div>
		</div>
		<script>
			function setup() {

				// Basic wires.
				Array.from(document.querySelectorAll("#BasicWiresForm .btn")).forEach((element) => {
					element.addEventListener("click", buttonDeselect);
					element.addEventListener("click", () => setTimeout(basicwires_solve));
				});


			}

			function basicwires_solve(e) {

				const colour = {
					white: "white",
					yellow: "yellow",
					blue: "blue",
					red: "red",
					black: "black"
				};

				const cut = {
					last: "last",
					first: "first",
					second: "2nd",
					fourth: "4th",
					third: "3rd"
				};

				getcount = (c) =>
					document.querySelectorAll(`.basicwires_${c}:checked`).length;

				let count = {
					red: getcount(colour.red),
					blue: getcount(colour.blue),
					yellow: getcount(colour.yellow),
					white: getcount(colour.white),
					black: getcount(colour.black),
					total: 0
				};

				lastwire = () => {
					w = document.querySelectorAll('.basicwires:checked');
					return w[w.length - 1].value;
				}

				count.total = count.red + count.blue + count.yellow + count.black + count.white;

				if (count.total < 3) {
					document.getElementById("basicwires_solution").innerHTML = "";
					return;
				}

				let result = [];
				switch (count.total) {
					case 3: {
						if (count.red == 0) {
							result.push(cut.second);
						} else if (lastwire() == colour.white) {
							result.push(cut.last);
						} else if (count.blue > 1) {
							result.push(`${cut.last} ${colour.blue}`);
						} else {
							result.push(cut.last);
						}
						break;
					}
					case 4: {
						if (count.red > 1) {
							result.push(`Serial odd: ${cut.last} ${colour.red}. Else: `);
						}
						if (lastwire() == colour.yellow && count.red == 0) {
							result.push(cut.first);
						} else if (count.blue == 1) {
							result.push(cut.first);
						} else if (count.yellow > 1) {
							result.push(cut.last);
						} else {
							result.push(cut.second);
						}
						break;
					}
					case 5: {
						if (lastwire() == colour.black) {
							result.push(`Serial odd: ${cut.fourth}. Else: `);
						}
						if (count.red == 1 && count.yellow > 1) {
							result.push(cut.first);
						} else if (count.black == 0) {
							result.push(cut.second);
						} else {
							result.push(cut.first);
						}
						break;
					}
					case 6: {
						if (count.yellow == 0) {
							result.push(`Serial odd: ${cut.third}. Else: `);
						}
						if (count.yellow == 1 && count.white > 1) {
							result.appendChild(cut.fourth);
						} else if (count.red == 0) {
							result.push(cut.last);
						} else {
							result.push(cut.fourth);
						}
						break;
					}
					default: {
						document.getElementById("basicwires_solution").innerHTML = "";
						return;
					}
				}

				console.log(`${result.join("")}`);
				document.getElementById("basicwires_solution").innerHTML = `Count= ${count.total}.<br />${result.join("")}`;
			}


			// Deprecated.
			function buttonDeselect(e) {
				if (document.getElementById(e.target.htmlFor).checked) {
					document.getElementById(e.target.htmlFor).checked = false;
					e.preventDefault();
				}
			}
			// Deprecated.
			function visible(e, visible) {
				const className = "d-none";
				if (visible && e.classList.contains(className)) {
					e.classList.remove(className); // Show.
				} else if (!visible && !e.classList.contains(className)) {
					e.classList.add(className); // Hide.
				}
			}
			// Deprecated.
			function show(e) {
				e.classList.remove("d-none"); // Show.
			}
			// Deprecated.
			function hide(e) {
				e.classList.add("d-none"); // Hide.
			}

		</script>
		<script src="./bundle.js"></script>
	</body>

</html>
